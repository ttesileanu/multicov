function test_checkconnectivity
% TEST_CHECKCONNECTIVITY Test checkconnectivity.m.

% 1-2-3 4-5
adj1 = [...
    0 1 1 0 0 ; ...
    1 0 1 0 0 ; ...
    1 1 0 0 0 ; ...
    0 0 0 0 1 ; ...
    0 0 0 1 0 ...
];
[conn1a, info1a] = checkconnectivity([1 4], adj1);
[conn1b, info1b] = checkconnectivity([1 2 3], adj1);
[conn1c, info1c] = checkconnectivity([1 2 4 5], adj1);
utexpect(abs(conn1a) < eps && abs(conn1b - 1) < eps && abs(conn1c - 1/3) < eps, ...
    'checkconnectivity');
utexpect(isequal(info1a.compsizes(:), [1 ; 1]) && ...
    isequal(info1b.compsizes(:), 3) && ...
    isequal(info1c.compsizes(:), [2 ; 2]), ...
    'checkconnectivity compsizes');

timer = tic;
% 1-2-3 4 5 6
adj2 = [...
    0 1 1 0 0 0 ; ...
    1 0 1 0 0 0 ; ...
    1 1 0 0 0 0 ; ...
    0 0 0 0 0 0 ; ...
    0 0 0 0 0 0 ; ...
    0 0 0 0 0 0 ...
];
[~, info2] = checkconnectivity([1 2 4], adj2, 'pvalue', true);
% at least as extreme groups:
%  [1 2 3],
%  [i j a] with i, j in (1, 2, 3), a one of (4, 5, 6) --> 9 groups
% less extreme groups
%  [i a b] with i in (1, 2, 3), a, b in (4, 5, 6) --> 9 groups
%  [4 5 6]
% --> p-value should be 0.5
utexpect(abs(info2.p - 0.5) < 0.1, 'checkconnectivity p-value', timer);

end